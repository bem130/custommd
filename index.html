<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>Rust Markdown Playground</title>
    <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/loader.js"></script>
</head>

<body>
    <h1>Rust Markdown Playground</h1>
    <div class="row">
        <div class="col">
            <h2>Markdown</h2>
            <div id="editor"></div>
            <button id="run-btn">変換</button>
        </div>
        <div class="col">
            <h2>HTML出力</h2>
            <iframe id="output-frame"
                style="width:100%;min-height:400px;border:1px solid #ccc;background:#fafafa;"></iframe>
        </div>
    </div>
    <script type="module">
        import init, { process_markdown } from './pkg/markdown_processor.js';
        let editor;
        require.config({ paths: { 'vs': 'https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs' } });
        require(['vs/editor/editor.main'], function () {
            editor = monaco.editor.create(document.getElementById('editor'), {
                value: '# サンプル\n説明文\n\ntags:\n- rust\n- wasm\n\n---\n\n## セクション\n内容\n',
                language: 'markdown',
                theme: 'vs-light',
                automaticLayout: true
            });
        });
        function setIframeHtml(html) {
            const iframe = document.getElementById('output-frame');
            iframe.srcdoc = html;
        }
        async function run() {
            await init();
            if (editor) {
                const html = process_markdown(editor.getValue());
                setIframeHtml(html);
            }
        }
        document.getElementById('run-btn').onclick = async () => {
            const md = editor.getValue();
            const html = process_markdown(md);
            console.log(html);
            setIframeHtml(html);
        };
        run();
    </script>
</body>

</html>
<style>
#editor {
    height: 300px;
    border: 1px solid #ccc;
}

#output {
    border: 1px solid #ccc;
    padding: 1em;
    min-height: 200px;
    background: #fafafa;
}

body {
    max-width: 900px;
    margin: 2em auto;
    font-family: sans-serif;
}

.row {
    display: flex;
    gap: 2em;
}

.col {
    flex: 1;
    min-width: 0;
}
</style>